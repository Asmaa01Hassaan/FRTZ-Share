<odoo>
    <template id="template_project_invoices" name="Project Invoices List">
        <t t-call="website.layout">
            <div class="container my-5">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h3 class="fw-bold mb-0">
                            <i class="bx bx-receipt me-2 text-primary"></i>
                            Project Invoices
                        </h3>
                        <small class="text-muted">المشروع:
                            <t t-esc="project.name"/>
                        </small>
                    </div>
                    <a t-attf-href="/my/invoice/create?project_id=#{project.id}" class="btn btn-primary shadow-sm">
                        <i class="bx bx-plus me-1"></i>
                        New Invoice
                    </a>
                </div>

                <div class="card shadow-sm border-0">
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead class="bg-light text-dark fw-bold">
                                    <tr>
                                        <th class="ps-4">Invoice Number</th>
                                        <th>Date</th>
                                        <th>Due Date</th>
                                        <th>Total Amount</th>
                                        <th>Payment Status</th>
                                        <th class="text-center">Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="invoices">
                                        <t t-foreach="invoices" t-as="invoice">
                                            <tr class="align-middle">
                                                <td class="ps-4 fw-bold text-primary">
                                                    <t t-esc="invoice.name if invoice.name != '/' else 'Draft Invoice'"/>
                                                </td>
                                                <td>
                                                    <span t-field="invoice.invoice_date"
                                                          t-options='{"widget": "date"}'/>
                                                </td>
                                                <td>
                                                    <span t-field="invoice.invoice_date_due"
                                                          t-options='{"widget": "date"}'/>
                                                </td>
                                                <td>
                                                    <span t-field="invoice.amount_total"/>
                                                </td>
                                                <td>
                                                    <span t-attf-class="badge rounded-pill #{'bg-success' if invoice.payment_state == 'paid' else 'bg-warning text-dark'}">
                                                        <t t-esc="dict(invoice._fields['payment_state'].selection).get(invoice.payment_state)"/>
                                                    </span>
                                                </td>
                                                <td class="text-center">
                                                    <a t-attf-href="/my/invoices/#{invoice.id}"
                                                       class="btn btn-sm btn-outline-primary">
                                                        View
                                                    </a>
                                                </td>
                                            </tr>
                                        </t>
                                    </t>
                                    <t t-else="">
                                        <tr>
                                            <td colspan="6" class="text-center py-5 text-muted">
                                                No invoices found for this project.
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="mt-4">
                    <a t-attf-href="/my/project/view/#{project.id}" class="text-muted">
                        <i class="bx bx-arrow-back me-1"></i>
                        Back to Project
                    </a>
                </div>
            </div>
        </t>
    </template>

    <template id="template_invoice_create" name="Portal Create Invoice">
        <t t-call="website.layout">
            <div class="container my-5">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h3 class="fw-bold mb-0">
                            <i class="bx bx-receipt me-2 text-primary"></i>
                            Create Invoice
                        </h3>
                        <small class="text-muted">إنشاء فاتورة جديدة</small>
                    </div>
                    <a t-attf-href="/my/project/invoices?project_id=#{project.id}"
                       class="btn btn-outline-secondary btn-sm">
                        <i class="bx bx-arrow-back me-1"></i>
                        Back to List
                    </a>
                </div>

                <div class="card shadow-sm border-0">
                    <div class="card-body">
                        <form action="/my/invoice/create/save" method="post">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <input type="hidden" name="project_id" t-att-value="project.id"/>

                            <div class="row mb-4">
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">Project</label>
                                    <input type="text" class="form-control" t-att-value="project.name" readonly="1"/>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold">Customer</label>
                                    <input type="text" class="form-control" t-att-value="partner.name" readonly="1"/>
                                </div>
                            </div>

                            <div class="row mb-4">
                                <div class="col-md-4">
                                    <label class="form-label fw-bold">Invoice Date</label>
                                    <input type="date" name="invoice_date" class="form-control" required="1"/>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label fw-bold">Due Date</label>
                                    <input type="date" name="invoice_date_due" class="form-control"/>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label fw-bold">Reference</label>
                                    <input type="text" name="ref" class="form-control"
                                           t-att-value="project.label_tasks"/>
                                </div>
                            </div>

                            <div class="mb-4">
                                <label class="form-label fw-bold">Invoice Description</label>
                                <textarea name="narration" class="form-control" rows="4"
                                          placeholder="Write invoice description..."></textarea>
                            </div>

                            <div class="d-flex justify-content-end gap-2">
                                <a t-attf-href="/my/project/view/#{project.id}"
                                   class="btn btn-outline-secondary">
                                    Cancel
                                </a>
                                <button type="submit" class="btn btn-primary px-4">
                                    Create Invoice
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </t>
    </template>
</odoo>